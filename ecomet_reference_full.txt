# eCOMET Reference Documentation


## Function/Topic: Interspecific Ecometabolomics Tutorial
URL: https://phytoecia.github.io/eCOMET/articles/Interspecific_study_tutorial.html

### Usage
```r
library(here)
here()

library(ecomet)
library(dplyr)
```

### Article Content Summary
Interspecific Ecometabolomics Tutorial
Interspecific_study_tutorial.Rmd

This Relative Paths will work if you open the .Rjroject.

library(here)
here()

library(ecomet)
library(dplyr)
#1) Created the mmo object

demo_feature <- here("tutorial/tutorial_2_interspecific/Ecomet_Interspecific_Demo_full_feature_table.csv")
demo_metadata <- here("tutorial/tutorial_2_interspecific/Ecomet_Interspecific_Demo_metadata_no_blanks.csv")
demo_sirius_formula <- here("tutorial/tutorial_2_interspecific/sirius/formula_identifications.tsv")
demo_sirius_structure <- here("tutorial/tutorial_2_interspecific/sirius/structure_identifications.tsv")
demo_dreams <- here("tutorial/tutorial_2_interspecific/Ecomet_Interspecific_Demo_dreams_sim_dreams.csv")


# Initialize eCOMET object
mmo <- GetMZmineFeature(mzmine_dir=demo_feature, metadata_dir = demo_metadata, group_col = 'Species',sample_col = "filename")
mmo <- AddFeatureInfo(mmo = mmo,full_feature_csv=demo_feature)
# Add normalizations
mmo <- ReplaceZero(mmo, method = 'one') # Replace 0 and NA values by 1
mmo <- LogNormalization(mmo) # Add log-transformed area
mmo <- ZNormalization(mmo) # Add Zscore
Now the mmo object contains the Feature x Abundance matrix where the first two columns identify individual metabolites and the remaining columns represent the abundance in each sample

mmo$feature_data
We can add the feature x feature pairwise distance to the mmo object based on the output of MzMine. This can accept modified cosine, dreaMS and MS2Deepscore

# Add Dreams distance
mmo <- AddChemDist(mmo, dreams_dir = demo_dreams)

mmo$dreams.dissim[1:10,1:10]
Sample Metadata: In this tutorial we are comparing 5 species of hickory along side a sample of Eastern black walnut.
mmometadatametadataSpecies
There are also two types of samples “pools” and "samples. Pools represent species pools where each individual sample for each spcies was combined and run for ms/ms data analysis. Samples represent MS1 data for anindividual plant.

mmo$metadata
Note we 

==================================================

## Function/Topic: Intro
URL: https://phytoecia.github.io/eCOMET/articles/Intro.html

### Usage
```r
library(ecomet)
```

### Article Content Summary
Intro
Intro.Rmd


library(ecomet)

The mmo object

The mmo object is a central data structure in the
eCOMET package.
It is created by the GetMZmineFeature() function and
contains:


feature_data: A data frame of metabolite features
and their measured values.

metadata: Sample metadata, including grouping
information.

pairwise: (optional) Results of pairwise
comparisons between features. Added by PairwiseComp().

sirius_annot: (optional) SIRIUS/CANOPUS class
annotations. Added by AddSiriusAnnot().

custom_annot: (optional) Custom compound
annotations. Added by AddCustomAnnot().

cos.dissim: (optional) Cosine dissimilarity matrix.
Added by AddChemdist().

m2ds.dissim: (optional) MS2DeepScore dissimilarity
matrix. Added by AddChemdist().

dreams.dissim: (optional) DreaMS dissimilarity
matrix. Added by AddChemdist().


You can create an mmo object like this:

mmo <- GetMZmineFeature(
  mzmine_dir = "path/to/mzmine_feature.csv",
  metadata_dir = "path/to/metadata.csv",
  group_col = "treatment"
)
Once created, you can use the mmo object for
normalization, annotation, statistical analysis, and visualization
throughout the package.


Input file requirements

The mendatory input files for creating an mmo object
are:


MZmine feature table:


This file is generated by MZMine (Feature list methods → Export
feature list → CSV). See MZMine_documentation




Metadata file: A CSV file containing sample
metadata, with following columns. -sample (___.mzML or equivalent
filename used as input of the MZmine), -mass (the sample mass which will
be used for normalization. just put 1 if not needed), -and at least one
grouping info column (the experimental group for each sample). Use as
input for ‘group_col’ argument of GetMZmineFeature().

Refer Inputs_MZMine below for
details.


Normalization

The raw peak area values are processed by following steps:

Replacing missing values (NA) with half of the minimum value for
each feature or 1.
Normalizing by sample mass (provided in metadata).


==================================================

## Function/Topic: Treatment-based_study_tutorial
URL: https://phytoecia.github.io/eCOMET/articles/Treatment-based_study_tutorial.html

### Usage
```r
#install.packages("pak")
#pak::pkg_install("Phytoecia/eCOMET", dependencies = TRUE)
#pak::pkg_install("Phytoecia/eCOMET", dependencies = TRUE, upgrade = TRUE)
library(ecomet)
library(dplyr)
#> 
#> Attaching package: 'dplyr'
#> The following objects are masked from 'package:stats':
#> 
#>     filter, lag
#> The following objects are masked from 'package:base':
#> 
#>     intersect, setdiff, setequal, union
library(stringr)
library(here)
#> here() starts at /Users/dlforrister/Library/CloudStorage/OneDrive-SmithsonianInstitution/One_Drive_BackUps_Local_Mac_Files/CODE_GIT_HUB_2017_Aug_31/eCOMET
here()
#> [1] "/Users/dlforrister/Library/CloudStorage/OneDrive-SmithsonianInstitution/One_Drive_BackUps_Local_Mac_Files/CODE_GIT_HUB_2017_Aug_31/eCOMET"
```

### Article Content Summary
Treatment-based_study_tutorial
2026-01-26
Treatment-based_study_tutorial.Rmd


#install.packages("pak")
#pak::pkg_install("Phytoecia/eCOMET", dependencies = TRUE)
#pak::pkg_install("Phytoecia/eCOMET", dependencies = TRUE, upgrade = TRUE)
library(ecomet)
library(dplyr)
#> 
#> Attaching package: 'dplyr'
#> The following objects are masked from 'package:stats':
#> 
#>     filter, lag
#> The following objects are masked from 'package:base':
#> 
#>     intersect, setdiff, setequal, union
library(stringr)
library(here)
#> here() starts at /Users/dlforrister/Library/CloudStorage/OneDrive-SmithsonianInstitution/One_Drive_BackUps_Local_Mac_Files/CODE_GIT_HUB_2017_Aug_31/eCOMET
here()
#> [1] "/Users/dlforrister/Library/CloudStorage/OneDrive-SmithsonianInstitution/One_Drive_BackUps_Local_Mac_Files/CODE_GIT_HUB_2017_Aug_31/eCOMET"

Background

In this tutorial, we will demonstrate how to use the
eCOMET package for analyzing metabolomics data from a
treatment-based study.

Treatment-based studies involve comparing metabolite profiles
between different treatment groups (e.g., control vs treated).
The tutorial covers data preprocessing, normalization,
statistical analysis, and visualization techniques commonly used in
treatment-based metabolomics studies.
The tutorial files are metabolomics analysis files of
Arabidopsis thaliana (Col-0) attacked by two different
herbivores (Spodoptera litura; sl, and Lipaphis
erysimi; le).
Eight replicates were sampled and analyzed for each group. See
metadata.csv for more details.

Tutorial data
eCOMET is distributed with a small set of example data files that are
installed automatically with the package. These files are included
specifically so that the tutorials can be run immediately, without
downloading additional data or setting file paths by hand.
The example datasets represent simplified versions of the feature
tables, metadata, and annotation outputs used in a typical eCOMET
analysis workflow. They are meant for demonstration and testing,

==================================================

## Function/Topic: eCOMET-intro
URL: https://phytoecia.github.io/eCOMET/articles/eCOMET-intro.html

### Usage
```r
library(ecomet)
```

### Article Content Summary
eCOMET-intro
Dale L.
Forrister & Min-Soo Choi
2026-01-26
eCOMET-intro.Rmd


library(ecomet)

The mmo object

The mmo object is a central data structure in the
eCOMET package.
It is created by the GetMZmineFeature() function and
contains:


feature_data: A data frame of metabolite features
and their measured values.

feature_info: A data frame of feature definitions
include mz and rt range and grouping information if feature grouping was
applied in mzmine.

metadata: Sample metadata, including grouping
information.

sirius_annot: (optional) SIRIUS/CANOPUS class
annotations. Added by AddSiriusAnnot().

custom_annot: (optional) Custom compound
annotations. Added by AddCustomAnnot().

cos.dissim: (optional) Cosine dissimilarity matrix.
Added by AddChemdist().

m2ds.dissim: (optional) MS2DeepScore dissimilarity
matrix. Added by AddChemdist().

dreams.dissim: (optional) DreaMS dissimilarity
matrix. Added by AddChemdist().



Input file requirements

The mendatory input files for creating an mmo object
are:


MZmine feature table:


This file is generated by MZMine (Feature list methods → Export
feature list → CSV). See MZMine_documentation




Metadata file: A CSV file containing sample
metadata, with following columns. -sample (___.mzML or equivalent
filename used as input of the MZmine), -mass (the sample mass which will
be used for normalization. just put 1 if not needed), -and at least one
grouping info column (the experimental group for each sample). Use as
input for ‘group_col’ argument of GetMZmineFeature().

Refer Inputs_MZMine below for
details.

You can create an mmo object like this:
mmo <- GetMZmineFeature( mzmine_dir =
“path/to/mzmine_feature.csv”, metadata_dir = “path/to/metadata.csv”,
group_col = “treatment” )
Here we load demo data that is downloaded when eCOMET is installed
and create an mmo object


# Locate tutorial data shipped with the eCOMET package
data_dir <- system.file(
  "extdata/tutorials/treatment_based",
  package = "ecomet"
)

stopifnot(nzch

==================================================

## Function/Topic: Articles
URL: https://phytoecia.github.io/eCOMET/articles/index.html

### Article Content Summary
Articles


Tutorials

eCOMET-intro

Treatment-based_study_tutorial

==================================================

## Function/Topic: vignette-eCOMET-intro
URL: https://phytoecia.github.io/eCOMET/articles/vignette-eCOMET-intro.html

### Usage
```r
library(ecomet)
```

### Article Content Summary
vignette-eCOMET-intro
vignette-eCOMET-intro.Rmd


library(ecomet)


mmo object?

The mmo object is a central data structure in the eCOMET package.
It is created by the GetMZmineFeature() function and contains:


feature_data: A data frame of metabolite features and their measured values.

metadata: Sample metadata, including grouping information.

pairwise: Results of pairwise comparisons between features. Added by PairwiseComp().

sirius_annot: (optional) SIRIUS/Canopus chemical annotations. Added by AddSiriusAnnot().

custom_annot: (optional) Custom compound annotations. Added by AddCustomAnnot().

You can create an mmo object like this:

mmo <- GetMZmineFeature(
  mzmine_dir = "path/to/mzmine_feature.csv",
  metadata_dir = "path/to/metadata.csv",
  group_col = "treatment"
)
Once created, you can use the mmo object for normalization, annotation, statistical analysis, and visualization throughout the package.


Input file requirements

The mendatory input files for creating an mmo object are: 1. MZmine feature table: 2. Metadata file: A CSV file containing sample metadata, with following columns: -sample (___.mzML or equivalent filename used as input of the MZmine), -mass (the sample mass which will be used for normalization. just put 1 if not needed), -and at least one grouping info column (the experimental group for each sample). 3.
See the demo files for examples. ### MZmine feature table Exported from MZmine as a CSV file. ### Metadata file A CSV file with at least three columns: sample, mass, and one grouping column (e.g., treatment). The sample column should match the filenames in the MZmine feature table. The mass column is used for normalization (set to 1 if not needed). The grouping column is used for statistical comparisons.

==================================================

## Function/Topic: Add chemical distance matrices to the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/AddChemDist.html

### Description
This function reads cosine, DREAMS, and MS2DeepScore molecular networking outputs from MZmine,
then transform the similarity to distance and adds the dissimilarity matrices to the mmo object.

### Usage
```r
AddChemDist(mmo, cos_dir = NULL, dreams_dir = NULL, m2ds_dir = NULL)
```

==================================================

## Function/Topic: Add custom annotations to an mmo object
URL: https://phytoecia.github.io/eCOMET/reference/AddCustomAnnot.html

### Description
Match features to a custom DB by m/z (ppm) and RT (minutes) tolerances and
attach a list-column of candidate compound IDs per feature.

### Usage
```r
AddCustomAnnot(mmo, DB_file, mztol = 5, rttol = 0.5)
```

==================================================

## Function/Topic: Add feature_info to an existing mmo from a full_feature CSV
URL: https://phytoecia.github.io/eCOMET/reference/AddFeatureInfo.html

### Description
Add feature_info to an existing mmo from a full_feature CSV

### Usage
```r
AddFeatureInfo(mmo, full_feature_csv)
```

==================================================

## Function/Topic: Adding annotation from SIRIUS to the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/AddSiriusAnnot.html

### Description
This function reads SIRIUS structure identification and formula summary files,
and adds the annotations to the mmo object.

### Usage
```r
AddSiriusAnnot(mmo, canopus_structuredir, canopus_formuladir)
```

==================================================

## Function/Topic: Generate barplots for each feature and perform ANOVA
URL: https://phytoecia.github.io/eCOMET/reference/AnovaBarPlot.html

### Description
This function generates bar plots for a specified feature across different groups in the metadata, performing ANOVA and Tukey's HSD test for post-hoc analysis.

### Usage
```r
AnovaBarPlot(
  mmo,
  ID_list,
  outdir,
  normalization = "None",
  filter_group = FALSE,
  group_list = NULL,
  save_output = TRUE,
  width = 6,
  height = 6
)
```

==================================================

## Function/Topic: BootCumulRichnessAUC
URL: https://phytoecia.github.io/eCOMET/reference/BootCumulRichnessAUC.html

### Description
This function bootstraps the normalized area under the curve (AUC) for cumulative richness by randomizing the order of groups.
It performs multiple bootstrap iterations to estimate the distribution of normalized AUC values.

### Usage
```r
BootCumulRichnessAUC(mmo, groups, n_boot = 500)
```

==================================================

## Function/Topic: BootstrapCumulativeRichness
URL: https://phytoecia.github.io/eCOMET/reference/BootstrapCumulativeRichness.html

### Description
This function bootstraps the cumulative richness of features across groups in the metadata by randomizing the order of groups.
It performs multiple bootstrap iterations to estimate the mean and confidence intervals of cumulative richness at each step.

### Usage
```r
BootstrapCumulativeRichness(mmo, groups, n_boot = 1000, ci = 0.95)
```

==================================================

## Function/Topic: CalcNormalizedAUC
URL: https://phytoecia.github.io/eCOMET/reference/CalcNormalizedAUC.html

### Description
This function calculates the normalized area under the curve (AUC) for a cumulative richness curve.
The normalized AUC is computed by dividing the AUC by the maximum possible area, which is the product of the maximum group index and maximum cumulative richness.

### Usage
```r
CalcNormalizedAUC(curve)
```

==================================================

## Function/Topic: CalculateCumulativeRichness
URL: https://phytoecia.github.io/eCOMET/reference/CalculateCumulativeRichness.html

### Description
This function calculates the cumulative richness of features across groups in the metadata.
Cumulative richness is defined as the total number of unique features observed as groups are added sequentially.

### Usage
```r
CalculateCumulativeRichness(mmo, groups)
```

==================================================

## Function/Topic: CalculateGroupBetaDistance
URL: https://phytoecia.github.io/eCOMET/reference/CalculateGroupBetaDistance.html

### Description
This function calculates the beta diversity distance between a reference group and other groups in the metadata.

### Usage
```r
CalculateGroupBetaDistance(mmo, beta_div, reference_group, groups)
```

==================================================

## Function/Topic: CalculateNullCumulativeRichness
URL: https://phytoecia.github.io/eCOMET/reference/CalculateNullCumulativeRichness.html

### Description
This function calculates the null model of cumulative richness by randomizing samples regardless of group.
It performs multiple bootstrap iterations to estimate the mean and confidence intervals of cumulative richness at each step.

### Usage
```r
CalculateNullCumulativeRichness(mmo, n_boot = 1000, n_groups, ci = 0.95)
```

==================================================

## Function/Topic: Generate a plot for enrichment analysis of Canopus-predicted terms across all levels
URL: https://phytoecia.github.io/eCOMET/reference/CanopusAllLevelEnrichmentPlot.html

### Description
This function generates a plot for enrichment analysis of Canopus-predicted terms across all levels,
showing fold enrichment, p-value, and subset count for each term level.

### Usage
```r
CanopusAllLevelEnrichmentPlot(
  mmo = mmo,
  comp.list,
  terms = "all_terms",
  term_levels = NULL,
  pthr = 0.1,
  representation = "greater",
  outdir = "enrichment",
  height = 10,
  width = 8,
  pval = "pval",
  save_output = TRUE
)
```

==================================================

## Function/Topic: Enrichment analysis for Canopus-predicted terms
URL: https://phytoecia.github.io/eCOMET/reference/CanopusLevelEnrichmentAnal.html

### Description
This function performs enrichment analysis for Canopus-predicted terms on a given list of features.

### Usage
```r
CanopusLevelEnrichmentAnal(
  mmo,
  list_test,
  pthr = 0.1,
  sig = TRUE,
  term_level = "NPC_pathway",
  representation = "greater",
  pval = "pval"
)
```

==================================================

## Function/Topic: Generate a plot for enrichment analysis of Canopus-predicted terms at a specific level using a list of vectors of features
URL: https://phytoecia.github.io/eCOMET/reference/CanopusLevelEnrichmentPlot.html

### Description
This function generates a plot for enrichment analysis of Canopus-predicted terms at a specific level,
showing fold enrichment, p-value, and subset count for each term.

### Usage
```r
CanopusLevelEnrichmentPlot(
  mmo = mmo,
  comp.list,
  term_level = "NPC_pathway",
  pthr = 0.1,
  representation = "greater",
  outdir = "enrichment",
  height = 5,
  width = 5,
  pval = "pval",
  save_output = TRUE
)
```

==================================================

## Function/Topic: Generate a plot for enrichment analysis of Canopus-predicted terms
URL: https://phytoecia.github.io/eCOMET/reference/CanopusListEnrichmentPlot.html

### Description
This function generates a plot for enrichment analysis of Canopus-predicted terms,
showing fold enrichment, p-value, and subset count for each term level.

### Usage
```r
CanopusListEnrichmentPlot(
  mmo,
  feature_list,
  pthr = 0.05,
  outdir,
  height = 5,
  width = 5,
  pval = "pval",
  save_output = TRUE
)
```

==================================================

## Function/Topic: Generate a plot for enrichment analysis of Canopus-predicted terms across multiple levels
URL: https://phytoecia.github.io/eCOMET/reference/CanopusListEnrichmentPlot_2.html

### Description
This function generates a plot for enrichment analysis of Canopus-predicted terms across multiple levels,
showing fold enrichment, p-value, and subset count for each term level.

### Usage
```r
CanopusListEnrichmentPlot_2(
  mmo,
  feature_list,
  pthr = 0.05,
  outdir,
  height = 5,
  width = 5,
  topn = 5,
  pval = "pval",
  save_output = TRUE
)
```

==================================================

## Function/Topic: ExportFeaturesToCSV
URL: https://phytoecia.github.io/eCOMET/reference/ExportFeaturesToCSV.html

### Description
This function exports selected features, their annotations, and pairwise comparisons to a CSV file.

### Usage
```r
ExportFeaturesToCSV(mmo, feature_list, normalization = "None", output_dir)
```

==================================================

## Function/Topic: Build a feature dendrogram from a dissimilarity matrix
URL: https://phytoecia.github.io/eCOMET/reference/FeatureDendrogram.html

### Description
Given a feature-to-feature dissimilarity matrix (e.g., DREAMS, cosine, MS2DeepScore),
cluster the features and optionally write a Newick tree for visualization in tools like iTOL.

### Usage
```r
FeatureDendrogram(
  mmo,
  distance = "dreams",
  features = NULL,
  method = "average",
  save_output = FALSE,
  outprefix = "feature_tree",
  layout = c("base", "circular"),
  npl_col = "NPC#class",
  group_col = "group",
  add_group_bars = TRUE,
  abundance_fun = c("mean", "sum")
)
```

==================================================

## Function/Topic: FeaturePerformanceRegression
URL: https://phytoecia.github.io/eCOMET/reference/FeaturePerformanceRegression.html

### Description
This function performs regression analysis of a specific feature against a phenotype performance in the metadata.
It can use linear mixed models (LMM), simple linear regression (LM), or Pearson correlation.

### Usage
```r
FeaturePerformanceRegression(
  mmo,
  target,
  phenotype,
  groups,
  model = "lmm",
  normalization = "Z",
  outdir = "FeaturePerformanceRegression",
  width = 6,
  height = 6,
  save_output = TRUE
)
```

==================================================

## Function/Topic: FeaturePhenotypeCorrelation
URL: https://phytoecia.github.io/eCOMET/reference/FeaturePhenotypeCorrelation.html

### Description
This function performs correlation analysis of a specific feature against a phenotype in the metadata.
It can use linear mixed models (LMM), simple linear regression (LM), or Pearson correlation.
The default regression line of the plot uses linear model

### Usage
```r
FeaturePhenotypeCorrelation(
  mmo,
  feature,
  phenotype,
  groups,
  model = "lm",
  normalization = "Z",
  outdir = "FeaturePhenotypeCorrelation",
  width = 6,
  height = 6,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Convert feature abundances to presence / absence
URL: https://phytoecia.github.io/eCOMET/reference/FeaturePresence.html

### Description
This function converts the feature abundance matrix in an mmo object
into a binary presence/absence matrix and stores it as a new component
of the mmo object (mmo$feature_presence).

### Usage
```r
FeaturePresence(mmo, threshold = 1)
```

==================================================

## Function/Topic: Convert feature names to IDs in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/FeatureToID.html

### Description
This function converts feature names to their corresponding IDs in the mmo object.

### Usage
```r
FeatureToID(mmo, feature_names)
```

==================================================

## Function/Topic: Generate input files to be used for pheatmap from the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/GenerateHeatmapInputs.html

### Description
This function generates heatmap inputs from the mmo object, including fold change or mean values,
distance matrix, and row labels for custom-annotated features.

### Usage
```r
GenerateHeatmapInputs(
  mmo,
  filter_feature = FALSE,
  feature_list = NULL,
  filter_group = FALSE,
  group_list = NULL,
  summarize = "mean",
  control_group = "ctrl",
  normalization = "None",
  distance = "dreams"
)
```

==================================================

## Function/Topic: GetAlphaDiversity
URL: https://phytoecia.github.io/eCOMET/reference/GetAlphaDiversity.html

### Description
This function calculates the alpha diversity for a given mmo object, order of the Hill number, normalization method, mode (weighted or unweighted), distance metric, and optional feature filtering.
Unweighted mode uses Hill numbers without considering feature dissimilarity, while weighted mode uses functional Hill numbers that account for feature dissimilarity.

### Usage
```r
GetAlphaDiversity(
  mmo,
  q = 1,
  normalization = "None",
  mode = "weighted",
  distance = "dreams",
  filter_feature = FALSE,
  feature_list = NULL
)
```

==================================================

## Function/Topic: GetBetaDiversity
URL: https://phytoecia.github.io/eCOMET/reference/GetBetaDiversity.html

### Description
This function calculates the beta diversity for a given mmo object, method (Generalized Unifrac, bray, jaccard, or CSCS), normalization method, distance metric, and optional feature filtering.
Then it returns a distance matrix of beta diversity values.
The Generalized UniFrac and CSCS method requires a distance matrix of feature dissimilarity, which is calculated using the specified distance metric.
Bray-Curtis and Jaccard methods are calculated using the vegan package, not considering feature dissimilarity.

### Usage
```r
GetBetaDiversity(
  mmo,
  method = "Gen.Uni",
  normalization = "None",
  distance = "dreams",
  filter_feature = FALSE,
  feature_list = NULL,
  filter_group = FALSE,
  group_list = NULL
)
```

==================================================

## Function/Topic: Generates lists of DAMs (Differentially Accumulated Metabolites) for each comparison in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/GetDAMs.html

### Description
This function generates lists of upregulated and downregulated DAMs for each pairwise comparison in the mmo object.
It uses log2 fold change and adjusted p-value thresholds to determine significance.
Make sure to run PairwiseComp() for all desired comparisons before using this function.

### Usage
```r
GetDAMs(mmo, fc_cutoff = 0.5849625, pval_cutoff = 0.05)
```

==================================================

## Function/Topic: Get the distance matrix from the mmo object based on the specified distance metric
URL: https://phytoecia.github.io/eCOMET/reference/GetDistanceMat.html

### Description
This function retrieves the distance matrix from the mmo object based on the specified distance metric.

### Usage
```r
GetDistanceMat(mmo, distance = "dreams")
```

==================================================

## Function/Topic: GetFunctionalHillNumber
URL: https://phytoecia.github.io/eCOMET/reference/GetFunctionalHillNumber.html

### Description
This function calculates the functional Hill number for a given mmo object, normalization method, and distance metric.
See https://nph.onlinelibrary.wiley.com/doi/full/10.1111/nph.18685 for details of the functional Hill number calculation.

### Usage
```r
GetFunctionalHillNumber(
  mmo,
  normalization = "None",
  q = 1,
  distance = "dreams",
  filter_feature = FALSE,
  feature_list = NULL
)
```

==================================================

## Function/Topic: Calculate group means from the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/GetGroupMeans.html

### Description
This function calculates and returns a dataframe of mean feature values for each group in the mmo object, with options for normalization and filtering.
Use SwitchGroup() to change the grouping variable before running this function.

### Usage
```r
GetGroupMeans(
  mmo,
  normalization = "None",
  filter_feature = FALSE,
  feature_list = NULL,
  filter_group = FALSE,
  group_list = NULL
)
```

==================================================

## Function/Topic: GetHillNumbers
URL: https://phytoecia.github.io/eCOMET/reference/GetHillNumbers.html

### Description
This function calculates the Hill numbers for a given mmo object, normalization method, and order of the Hill number without considering feature dissimilarity.

### Usage
```r
GetHillNumbers(
  mmo,
  normalization = "None",
  q = 0,
  filter_feature = FALSE,
  feature_list = NULL
)
```

==================================================

## Function/Topic: Calculate log2 fold change for a given control group
URL: https://phytoecia.github.io/eCOMET/reference/GetLog2FoldChange.html

### Description
This function calculates and returns a dataframe of log2 fold change values for each group compared to a specified control group.
Takes inputs from GetGroupMeans() function.

### Usage
```r
GetLog2FoldChange(group_means, control_group)
```

==================================================

## Function/Topic: Import MZmine feature table and metadata to create a mmo object
URL: https://phytoecia.github.io/eCOMET/reference/GetMZmineFeature.html

### Description
Reads an MZmine exported feature table (typically the full feature table) and a sample metadata table
to initialize an mmo object containing:mmo$feature_data: feature-by-sample abundance matrix (peak areas)
mmo$feature_info: feature-level annotations (e.g., mz, rt, ranges, IDs)
mmo$metadata: sample metadata with standardized sample and group columns
Sample columns in the MZmine table are matched to metadata using fuzzy string matching on area column names.

### Usage
```r
GetMZmineFeature(
  mzmine_dir,
  metadata_dir,
  group_col,
  sample_col,
  drop_missing_samples = FALSE,
  mz_col = NULL,
  rt_col = NULL,
  max_distance = 5,
  feature_info_cols = c("id", "rt", "rt_range:min", "rt_range:max", "mz", "mz_range:min",
    "mz_range:max", "feature_group", "ion_identities:iin_id",
    "ion_identities:ion_identities")
)
```

==================================================

## Function/Topic: Retrieve feature data from the mmo object, with normalization options
URL: https://phytoecia.github.io/eCOMET/reference/GetNormFeature.html

### Description
This function retrieves the feature data from the mmo object based on the specified normalization method.

### Usage
```r
GetNormFeature(mmo, normalization)
```

==================================================

## Function/Topic: GetPerformanceFeatureCorrelation
URL: https://phytoecia.github.io/eCOMET/reference/GetPerformanceFeatureCorrelation.html

### Description
This function calculates the Pearson correlation between each feature and a specified phenotype performance in the metadata.

### Usage
```r
GetPerformanceFeatureCorrelation(
  mmo,
  phenotype,
  groups,
  DAM.list,
  comparisons,
  cor_method = "pearson",
  normalization = "None"
)
```

==================================================

## Function/Topic: GetPerformanceFeatureLMM
URL: https://phytoecia.github.io/eCOMET/reference/GetPerformanceFeatureLMM.html

### Description
This function performs linear mixed model analysis of all features against a phenotype performance in the metadata.

### Usage
```r
GetPerformanceFeatureLMM(
  mmo,
  phenotype,
  groups,
  DAM.list,
  comparisons,
  normalization = "Z"
)
```

==================================================

## Function/Topic: GetPerformanceFeatureRegression
URL: https://phytoecia.github.io/eCOMET/reference/GetPerformanceFeatureRegression.html

### Description
This function performs linear regression analysis of all features against a phenotype performance in the metadata.

### Usage
```r
GetPerformanceFeatureRegression(
  mmo,
  phenotype,
  groups,
  DAM.list,
  comparisons,
  normalization = "None"
)
```

==================================================

## Function/Topic: GetRichness
URL: https://phytoecia.github.io/eCOMET/reference/GetRichness.html

### Description
This function calculates the richness of features for each sample in the mmo object.
Richness is defined as the number of non-missing features observed in each sample.

### Usage
```r
GetRichness(mmo, filter_feature = FALSE, feature_list = NULL)
```

==================================================

## Function/Topic: GetSpecializationIndex
URL: https://phytoecia.github.io/eCOMET/reference/GetSpecializationIndex.html

### Description
This function calculates the specialization index for a given mmo object, normalization method, and optional filtering by groups and features.

### Usage
```r
GetSpecializationIndex(
  mmo,
  normalization = "None",
  filter_group = FALSE,
  group_list = NULL,
  filter_feature = FALSE,
  feature_list = NULL
)
```

==================================================

## Function/Topic: HCplot
URL: https://phytoecia.github.io/eCOMET/reference/HCplot.html

### Description
Hierarchical clustering of samples from a precomputed beta-diversity matrix
and plotting as a phylogram with tip labels colored by species (or any grouping column).

### Usage
```r
HCplot(
  mmo,
  betadiv,
  outdir,
  group_col = "Species_binomial",
  sample_col = "sample",
  hclust_method = "average",
  palette = "Dark 3",
  cex = 0.6,
  width = 10,
  height = 7,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Convert feature IDs to names in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/IDToFeature.html

### Description
This function converts feature IDs to their corresponding names in the mmo object.

### Usage
```r
IDToFeature(mmo, feature_ids)
```

==================================================

## Function/Topic: Load an mmo object previously saved with SaveMMO
URL: https://phytoecia.github.io/eCOMET/reference/LoadMMO.html

### Description
This function returns the loaded mmo object (visible return). By default it prints basic
information about the R version and recorded packages that were present when the object
was saved.

### Usage
```r
LoadMMO(file, check_session = TRUE, verbose = TRUE)
```

==================================================

## Function/Topic: Log-normalize the peak area in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/LogNormalization.html

### Description
This function applies log2 transformation to the peak area in the feature data of the mmo object.
Run ReplaceZero() before this function to avoid -Inf values.

### Usage
```r
LogNormalization(mmo)
```

==================================================

## Function/Topic: Metabolite Set Enrichment Analysis (MSEA)
URL: https://phytoecia.github.io/eCOMET/reference/MSEA.html

### Description
This function performs Metabolite Set Enrichment Analysis (MSEA) using the fgsea package.
It takes a ranked list of feature scores and tests for enrichment of metabolite sets based on Canopus-predicted terms.
The results are saved as a CSV file and a PDF plot.

### Usage
```r
MSEA(
  mmo,
  feature_name,
  feature_score,
  term_level = "NPC_class",
  pthr = 0.05,
  outdir = "MSEA",
  width = 8,
  height = 12,
  sig = FALSE,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Use sample mass in the metadata file to normalize the peak area
URL: https://phytoecia.github.io/eCOMET/reference/MassNormalization.html

### Description
This function normalizes the peak area in the feature data of the mmo object by the mass of each sample, provided in the metadata.
The feature data is replaced by (original value * mean mass) / sample mass.

### Usage
```r
MassNormalization(mmo)
```

==================================================

## Function/Topic: Mean-center the peak area in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/MeancenterNormalization.html

### Description
This function applies mean-centering to the peak area in the feature data of the mmo object.

### Usage
```r
MeancenterNormalization(mmo)
```

==================================================

## Function/Topic: NMDSplot
URL: https://phytoecia.github.io/eCOMET/reference/NMDSplot.html

### Description
This function generates a Non-metric Multidimensional Scaling (NMDS) plot based on the provided beta diversity distance matrix.
It also performs PERMANOVA analysis to assess the significance of group differences and saves the results to CSV files.

### Usage
```r
NMDSplot(
  mmo,
  betadiv,
  outdir,
  width = 6,
  height = 6,
  color,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Plots PCA and performs PERMANOVA
URL: https://phytoecia.github.io/eCOMET/reference/PCAplot.html

### Description
This function performs PCA analysis and generates a PCA plot with optional filtering of features and groups.
It also conducts PERMANOVA and saves the results to CSV files.

### Usage
```r
PCAplot(
  mmo,
  color,
  outdir = "PCA",
  normalization = "Z",
  filter_feature = FALSE,
  feature_list = NULL,
  filter_group = FALSE,
  group_list = NULL,
  label = TRUE,
  save_output = TRUE
)
```

==================================================

## Function/Topic: PCoAplot
URL: https://phytoecia.github.io/eCOMET/reference/PCoAplot.html

### Description
This function generates a Principal Coordinates Analysis (PCoA) plot based on the provided beta diversity distance matrix.
It also performs PERMANOVA analysis to assess the significance of group differences and saves the
results to CSV files.

### Usage
```r
PCoAplot(
  mmo,
  betadiv,
  outdir,
  width = 6,
  height = 6,
  color,
  save_output = TRUE
)
```

==================================================

## Function/Topic: PLS-DA plot with feature loadings
URL: https://phytoecia.github.io/eCOMET/reference/PLSDAplot.html

### Description
PLS-DA plot with feature loadings

### Usage
```r
PLSDAplot(
  mmo,
  color,
  topk = 10,
  outdir,
  normalization = "Z",
  filter_feature = FALSE,
  feature_list = NULL,
  filter_group = FALSE,
  group_list = NULL,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Perform pairwise comparison between two groups in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/PairwiseComp.html

### Description
This function performs pairwise comparison between two groups in the mmo object,
calculating log2 fold change and adjusted p-values for given comparison of two groups.
The function adds the results to the mmo$pairwise data frame.

### Usage
```r
PairwiseComp(mmo, group1, group2, correction = "BH")
```

==================================================

## Function/Topic: PlotFoldchangeResistanceQuad
URL: https://phytoecia.github.io/eCOMET/reference/PlotFoldchangeResistanceQuad.html

### Description
This function plots the fold change resistance in a quadrant plot, categorizing points into quadrants based on their effect size and fold change.
It also performs a binomial test to assess the distribution of points across quadrants.

### Usage
```r
PlotFoldchangeResistanceQuad(
  performance_regression,
  fold_change,
  color,
  output_dir,
  save_output = TRUE,
  width = 6,
  height = 6
)
```

==================================================

## Function/Topic: PlotFoldchangeResistanceRegression
URL: https://phytoecia.github.io/eCOMET/reference/PlotFoldchangeResistanceRegression.html

### Description
This function plots the regression results of a feature against a fold change in resistance, including
regression line, p-value, and R-squared value.

### Usage
```r
PlotFoldchangeResistanceRegression(
  performance_regression,
  fold_change,
  color,
  outdir,
  width = 6,
  height = 6,
  save_output = TRUE
)
```

==================================================

## Function/Topic: PlotFoldchangeResistanceRegression_t
URL: https://phytoecia.github.io/eCOMET/reference/PlotFoldchangeResistanceRegression_t.html

### Description
This function plots the regression results of a feature against a fold change in resistance, including
regression line, p-value, and R-squared value. Transposed version of PlotFoldchangeResistanceRegression.

### Usage
```r
PlotFoldchangeResistanceRegression_t(
  performance_regression,
  fold_change,
  color,
  output_dir,
  save_output = TRUE,
  width = 6,
  height = 6
)
```

==================================================

## Function/Topic: PlotNPCStackedBar
URL: https://phytoecia.github.io/eCOMET/reference/PlotNPCStackedBar.html

### Description
This function generates a stacked bar plot showing the count of features in each group categorized by NPC_pathway.
It uses the mmo object with sirius annotation and normalized data.
Make sure you don't run ReplaceZero() before using this function, as it may remove presence/absence information.

### Usage
```r
PlotNPCStackedBar(
  mmo,
  group_col,
  outdir,
  width = 6,
  height = 3,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Reorder samples in the mmo object based on group order
URL: https://phytoecia.github.io/eCOMET/reference/ReorderGroups.html

### Description
This function reorders the samples in the mmo object based on a specified group order.
The function updates the order of samples in the feature data, log-normalized data, z-score data, and mean-centered data.
Use this function before plotting heatmaps or other visualizations to ensure consistent group ordering.

### Usage
```r
ReorderGroups(mmo, group_order)
```

==================================================

## Function/Topic: Replace zero and NA values in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/ReplaceZero.html

### Description
This function replaces zero and NA values in the feature data of the mmo object.
Run this function before MassNormalization(), LogNormalization(), MeancenterNormalization(), or ZNormalization().

### Usage
```r
ReplaceZero(mmo, method = "one")
```

==================================================

## Function/Topic: Save entire mmo object to a file (RDS)
URL: https://phytoecia.github.io/eCOMET/reference/SaveMMO.html

### Description
Save entire mmo object to a file (RDS)

### Usage
```r
SaveMMO(mmo, file = "mmo.rds", compress = "xz", include_session = TRUE)
```

==================================================

## Function/Topic: Screen feature-phenotype correlation
URL: https://phytoecia.github.io/eCOMET/reference/ScreenFeaturePhenotypeCorrelation.html

### Description
Use metadata-provided variables (any phenotypes or environmental variables) to screen feature-phenotype correlation
linear model, linear mixed model (using groups as random effect), or correlation (Pearson, Spearman, Kendall) are supported

### Usage
```r
ScreenFeaturePhenotypeCorrelation(
  mmo,
  phenotype,
  groups,
  model = "lm",
  normalization = "None"
)
```

==================================================

## Function/Topic: Switch the group column in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/SwitchGroup.html

### Description
This function switches the group column in the metadata of the mmo object to a new specified column.
The new group column must exist in the metadata file.

### Usage
```r
SwitchGroup(mmo, new_group_col)
```

==================================================

## Function/Topic: Volcano plot for visualizing differential metabolite analysis results
URL: https://phytoecia.github.io/eCOMET/reference/VolcanoPlot.html

### Description
This function generates a volcano plot using data from mmo$pairwise (PairwiseComp(mmo, 'group1', 'group2') should be precended),
highlighting upregulated and downregulated features based on log2 fold change and adjusted p-value

### Usage
```r
VolcanoPlot(
  mmo,
  comp,
  topk = 10,
  pthr = 0.05,
  outdir = "volcano.png",
  height = 5,
  width = 5,
  save_output = TRUE
)
```

==================================================

## Function/Topic: Z-normalize the peak area in the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/ZNormalization.html

### Description
This function applies Z-score normalization to the peak area in the feature data of the mmo object.

### Usage
```r
ZNormalization(mmo)
```

==================================================

## Function/Topic: Annotate mmo$feature_info with MS2 presence and MS2 block counts from an MGF
URL: https://phytoecia.github.io/eCOMET/reference/annotate_feature_info_ms2_from_mgf.html

### Description
Scan an .mgf file and summarize MS/MS availability for each feature in
mmo$feature_info. The function adds two columns:ms2: TRUE if the MGF contains at least one MSLEVEL=2
block for that id; otherwise FALSE.
count_ms2: number of MSLEVEL=2 blocks for that id.

### Usage
```r
annotate_feature_info_ms2_from_mgf(
  mmo,
  mgf_path,
  chunk_lines = 100000L,
  overwrite = FALSE,
  verbose = TRUE
)
```

==================================================

## Function/Topic: Perform ANOVA and Tukey's HSD test on the mmo object
URL: https://phytoecia.github.io/eCOMET/reference/anova_tukey_dunnett.html

### Description
This function performs ANOVA and Tukey's HSD test on the feature data of the mmo object,
Returns a list of ANOVA results, Tukey's HSD results, Tukey's significance letters, and Dunnett's test results.

### Usage
```r
anova_tukey_dunnett(df, formula)
```

==================================================

## Function/Topic: Internal imports for ecomet
URL: https://phytoecia.github.io/eCOMET/reference/ecomet-internal-imports.html

### Description
Internal imports for ecomet

==================================================

## Function/Topic: Filter CANOPUS / SIRIUS annotations in an ecomet mmo object by probability threshold
URL: https://phytoecia.github.io/eCOMET/reference/filter_canopus_annotations.html

### Description
Applies a minimum-probability cutoff to selected CANOPUS (NPClassifier / ClassyFire)
annotation levels inside an ecomet mmo object. The function reads a chosen
annotation table from mmo[[input]] (default "sirius_annot"), flags
annotations below threshold by setting them to NA, and stores the result
as a new element on mmo named "sirius_annot_filtered_<suffix>".

### Usage
```r
filter_canopus_annotations(
  mmo,
  input = "sirius_annot",
  pathway_level = "NPC#pathway",
  threshold = 0.9,
  na_prob = TRUE,
  suffix = NULL,
  overwrite = FALSE,
  verbose = TRUE
)
```

==================================================

## Function/Topic: Filter SIRIUS structure (CSI:FingerID) annotations by COSMIC confidence score
URL: https://phytoecia.github.io/eCOMET/reference/filter_cosmic_structure.html

### Description
Applies a minimum COSMIC confidence cutoff to SIRIUS structure predictions inside an
ecomet mmo object. The function reads a chosen annotation table from
mmo[[input]] (default "sirius_annot"), flags structure annotations below
threshold by setting selected structure-identification fields to NA,
and stores the result as a new element on mmo named
"sirius_annot_filtered_<suffix>".

### Usage
```r
filter_cosmic_structure(
  mmo,
  input = "sirius_annot",
  cosmic_mode = c("exact", "approx"),
  threshold = 0.5,
  fields = "auto",
  na_cosmic = TRUE,
  suffix = NULL,
  overwrite = FALSE,
  verbose = TRUE
)
```

==================================================

## Function/Topic: Filter an MGF file to keep only spectra for features present in mmo$feature_data$id
URL: https://phytoecia.github.io/eCOMET/reference/filter_mgf_to_mmo.html

### Description
Create a new .mgf file that contains only spectra (ION blocks) whose
FEATURE_ID occurs in mmo$feature_data$id. This is useful for keeping
your spectral library in sync with the features currently stored in an mmo
object (e.g., after subsetting, filtering, or rebuilding an mmo).

### Usage
```r
filter_mgf_to_mmo(
  mmo,
  mgf_path,
  output_path = NULL,
  chunk_lines = 100000L,
  verbose = TRUE
)
```

==================================================

## Function/Topic: Filter an mmo object by samples, groups, and/or features
URL: https://phytoecia.github.io/eCOMET/reference/filter_mmo.html

### Description
Subset all components of an mmo object (feature tables, metadata, distance
matrices, and annotations) to a given set of samples, groups, and/or
feature IDs. Filtering is applied consistently across all slots present
in mmo.
Optionally, if an mgf_path is provided, a filtered MGF is written
containing only spectra for the retained features (using filter_mgf_to_mmo()).

### Usage
```r
filter_mmo(
  mmo,
  sample_list = NULL,
  group_list = NULL,
  feature_list = NULL,
  sample_col = "sample",
  group_col = "group",
  drop_empty_feat = TRUE,
  empty_threshold = NULL,
  mgf_path = NULL,
  output_path = NULL
)
```

==================================================

## Function/Topic: Package index
URL: https://phytoecia.github.io/eCOMET/reference/index.html

==================================================

## Function/Topic: Perform PERMANOVA and pairwise comparisons
URL: https://phytoecia.github.io/eCOMET/reference/permanova_stat.html

### Description
This function performs PERMANOVA on the given data and metadata, with options for filtering groups.
It also conducts post-hoc pairwise comparisons and adjusts p-values for multiple testing.
The function returns the PERMANOVA results, raw pairwise comparison results, and matrices of adjusted p-values, F values, and R square for pairwise comparisons

### Usage
```r
permanova_stat(
  data,
  metadata,
  mode,
  filter_group = FALSE,
  group_list = NULL,
  permutations = 5000
)
```

==================================================

## Function/Topic: Print method for mmo objects Provides a clean, human-readable overview of an mmo list object instead of dumping the entire list when the object is printed in the console.
URL: https://phytoecia.github.io/eCOMET/reference/print.mmo.html

### Description
Print method for mmo objects
Provides a clean, human-readable overview of an mmo list object instead of
dumping the entire list when the object is printed in the console.

### Usage
```r
# S3 method for class 'mmo'
print(x, ...)
```

==================================================

## Function/Topic: Write results of anova_tukey_dunnett to a CSV file
URL: https://phytoecia.github.io/eCOMET/reference/write_anova.html

### Description
This function writes the results of ANOVA and Tukey's HSD test to a CSV file.

### Usage
```r
write_anova(anova_data, outdir, way = "oneway")
```

==================================================
